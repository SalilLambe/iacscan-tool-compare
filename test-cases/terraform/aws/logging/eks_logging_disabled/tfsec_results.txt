
Result #1 CRITICAL Public cluster access is enabled. 
────────────────────────────────────────────────────────────────────────────────
 main.tf Lines 22-24
───────┬────────────────────────────────────────────────────────────────────────
   22  │   vpc_config {
   23  │     subnet_ids = [aws_subnet.subnet1.id]
   24  │   }
───────┴────────────────────────────────────────────────────────────────────────
          ID aws-eks-no-public-cluster-access
      Impact EKS can be access from the internet
  Resolution Don't enable public access to EKS Clusters

  More Information
  - https://aquasecurity.github.io/tfsec/v1.8.0/checks/aws/eks/no-public-cluster-access/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#endpoint_public_access
────────────────────────────────────────────────────────────────────────────────


Result #2 CRITICAL Cluster allows access from a public CIDR: 0.0.0.0/0. 
────────────────────────────────────────────────────────────────────────────────
 main.tf Lines 22-24
───────┬────────────────────────────────────────────────────────────────────────
   22  │   vpc_config {
   23  │     subnet_ids = [aws_subnet.subnet1.id]
   24  │   }
───────┴────────────────────────────────────────────────────────────────────────
          ID aws-eks-no-public-cluster-access-to-cidr
      Impact EKS can be accessed from the internet
  Resolution Don't enable public access to EKS Clusters

  More Information
  - https://aquasecurity.github.io/tfsec/v1.8.0/checks/aws/eks/no-public-cluster-access-to-cidr/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#vpc_config
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Cluster does not have secret encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
 main.tf Lines 19-25
───────┬────────────────────────────────────────────────────────────────────────
   19  │ resource "aws_eks_cluster" "test" {
   20  │   name = "test"
   21  │   role_arn = aws_iam_role.eksrole.arn
   22  │   vpc_config {
   23  │     subnet_ids = [aws_subnet.subnet1.id]
   24  │   }
   25  │ }
───────┴────────────────────────────────────────────────────────────────────────
          ID aws-eks-encrypt-secrets
      Impact EKS secrets could be read if compromised
  Resolution Enable encryption of EKS secrets

  More Information
  - https://aquasecurity.github.io/tfsec/v1.8.0/checks/aws/eks/encrypt-secrets/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#encryption_config
────────────────────────────────────────────────────────────────────────────────


Results #4-8 MEDIUM Control plane authenticator logging is not enabled. (5 similar results)
────────────────────────────────────────────────────────────────────────────────
 main.tf Lines 19-25
───────┬────────────────────────────────────────────────────────────────────────
   19  │ resource "aws_eks_cluster" "test" {
   20  │   name = "test"
   21  │   role_arn = aws_iam_role.eksrole.arn
   22  │   vpc_config {
   23  │     subnet_ids = [aws_subnet.subnet1.id]
   24  │   }
   25  │ }
───────┴────────────────────────────────────────────────────────────────────────
  Individual Causes
  - /src/main.tf:19-25 (aws_eks_cluster.test)
  - /src/main.tf:19-25 (aws_eks_cluster.test)
  - /src/main.tf:19-25 (aws_eks_cluster.test)
  - /src/main.tf:19-25 (aws_eks_cluster.test)
  - /src/main.tf:19-25 (aws_eks_cluster.test)
────────────────────────────────────────────────────────────────────────────────
          ID aws-eks-enable-control-plane-logging
      Impact Logging provides valuable information about access and usage
  Resolution Enable logging for the EKS control plane

  More Information
  - https://aquasecurity.github.io/tfsec/v1.8.0/checks/aws/eks/enable-control-plane-logging/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/eks_cluster#enabled_cluster_log_types
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             537.33µs
  parsing              710.641µs
  adaptation           80.205µs
  checks               2.979371ms
  total                4.307547ms

  counts
  ──────────────────────────────────────────
  blocks               5
  modules              1
  files                1

  results
  ──────────────────────────────────────────
  ignored              0
  excluded             0
  critical             2
  high                 1
  medium               5
  low                  0

  8 potential problem(s) detected.


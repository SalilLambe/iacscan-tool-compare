{
  "meta": {
    "isPrivate": true,
    "isLicensesEnabled": false,
    "ignoreSettings": null,
    "org": "salillambe",
    "policy": ""
  },
  "filesystemPolicy": false,
  "vulnerabilities": [],
  "dependencyCount": 0,
  "licensesPolicy": null,
  "ignoreSettings": null,
  "targetFile": "main.tf",
  "projectName": "project",
  "org": "salillambe",
  "policy": "",
  "isPrivate": true,
  "targetFilePath": "/project/main.tf",
  "packageManager": "terraformconfig",
  "path": "/project",
  "projectType": "terraformconfig",
  "ok": false,
  "infrastructureAsCodeIssues": [
    {
      "severity": "high",
      "resolve": "Set the `acl` attribute to `private`, or remove the attribute",
      "id": "SNYK-CC-TF-19",
      "impact": "That you may be leaking sensitive information to members of the public and this data could be modified with your knowledge.",
      "msg": "input.resource.aws_s3_bucket[dist].acl",
      "remediation": {
        "cloudformation": "Set the `Properties.AccessControl` attribute to `private`, or remove the attribute",
        "terraform": "Set the `acl` attribute to `private`, or remove the attribute"
      },
      "subType": "S3",
      "issue": "That this S3 bucket is publicly writeable without any authentication or authorization. ",
      "publicId": "SNYK-CC-TF-19",
      "title": "S3 Bucket is publicly readable and writable",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/acl-overview.html#canned-acl"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "That this S3 bucket is publicly writeable without any authentication or authorization. ",
        "impact": "That you may be leaking sensitive information to members of the public and this data could be modified with your knowledge.",
        "resolve": "Set the `acl` attribute to `private`, or remove the attribute"
      },
      "lineNumber": 16,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-19",
      "isGeneratedByCustomRule": false,
      "path": [
        "input",
        "resource",
        "aws_s3_bucket[dist]",
        "acl"
      ]
    },
    {
      "severity": "medium",
      "resolve": "Set `default_cache_behavior.viewer_protocol_policy` attribute to `redirect-to-https` or `https-only`",
      "id": "SNYK-CC-TF-57",
      "impact": "The content could be intercepted and manipulated in transit",
      "msg": "resource.aws_cloudfront_distribution[s3_distribution].default_cache_behavior.viewer_protocol_policy",
      "remediation": {
        "cloudformation": "Set `Properties.DistributionConfig.ViewerProtocolPolicy` attribute to `redirect-to-https` or `https-only`",
        "terraform": "Set `default_cache_behavior.viewer_protocol_policy` attribute to `redirect-to-https` or `https-only`"
      },
      "subType": "CloudFront",
      "issue": "Cloudfront distribution does not enforce HTTPS",
      "publicId": "SNYK-CC-TF-57",
      "title": "Cloudfront distribution does not enforce HTTPS",
      "references": [
        "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/distribution-web-values-specify.html#DownloadDistValuesViewerProtocolPolicy",
        "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/using-https-viewers-to-cloudfront.html"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "Cloudfront distribution does not enforce HTTPS",
        "impact": "The content could be intercepted and manipulated in transit",
        "resolve": "Set `default_cache_behavior.viewer_protocol_policy` attribute to `redirect-to-https` or `https-only`"
      },
      "lineNumber": 64,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-57",
      "isGeneratedByCustomRule": false,
      "path": [
        "resource",
        "aws_cloudfront_distribution[s3_distribution]",
        "default_cache_behavior",
        "viewer_protocol_policy"
      ]
    },
    {
      "severity": "low",
      "resolve": "For AWS provider < v4.0.0, add `logging` block attribute. For AWS provider >= v4.0.0, add aws_s3_bucket_logging resource.",
      "impact": "There will be no audit trail of access to s3 objects",
      "msg": "input.resource.aws_s3_bucket[logging].logging",
      "remediation": {
        "cloudformation": "Set `Properties.LoggingConfiguration` attribute",
        "terraform": "For AWS provider < v4.0.0, add `logging` block attribute. For AWS provider >= v4.0.0, add aws_s3_bucket_logging resource."
      },
      "subType": "S3",
      "issue": "The s3 access logs will not be collected",
      "publicId": "SNYK-CC-TF-45",
      "title": "S3 server access logging is disabled",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev/ServerLogs.html"
      ],
      "id": "SNYK-CC-TF-45",
      "isIgnored": false,
      "iacDescription": {
        "issue": "The s3 access logs will not be collected",
        "impact": "There will be no audit trail of access to s3 objects",
        "resolve": "For AWS provider < v4.0.0, add `logging` block attribute. For AWS provider >= v4.0.0, add aws_s3_bucket_logging resource."
      },
      "lineNumber": 5,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-45",
      "isGeneratedByCustomRule": false,
      "path": [
        "input",
        "resource",
        "aws_s3_bucket[logging]",
        "logging"
      ]
    },
    {
      "severity": "low",
      "resolve": "For AWS provider < v4.0.0, set `versioning.enabled` attribute to `true`. For AWS provider >= v4.0.0, add aws_s3_bucket_versioning resource.",
      "id": "SNYK-CC-TF-124",
      "impact": "Changes or deletion of objects will not be reversible",
      "msg": "resource.aws_s3_bucket[dist].versioning.enabled",
      "remediation": {
        "cloudformation": "Set `Properties.VersioningConfiguration.Status` attribute to `Enabled`",
        "terraform": "For AWS provider < v4.0.0, set `versioning.enabled` attribute to `true`. For AWS provider >= v4.0.0, add aws_s3_bucket_versioning resource."
      },
      "subType": "S3",
      "issue": "S3 bucket versioning is disabled",
      "publicId": "SNYK-CC-TF-124",
      "title": "S3 bucket versioning disabled",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "S3 bucket versioning is disabled",
        "impact": "Changes or deletion of objects will not be reversible",
        "resolve": "For AWS provider < v4.0.0, set `versioning.enabled` attribute to `true`. For AWS provider >= v4.0.0, add aws_s3_bucket_versioning resource."
      },
      "lineNumber": 14,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-124",
      "isGeneratedByCustomRule": false,
      "path": [
        "resource",
        "aws_s3_bucket[dist]",
        "versioning",
        "enabled"
      ]
    },
    {
      "severity": "low",
      "resolve": "Follow instructions in `https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html` to manually configure the MFA setting. For AWS provider < v4.0.0 set `versioning.mfa_delete` attribute to `true` in aws_s3_bucket resource. For AWS provider >= v4.0.0 set 'versioning_configuration.mfa_delete` attribute to `Enabled`. The terraform change is required to reflect the setting in the state file",
      "impact": "Object could be deleted without stronger MFA authorization",
      "msg": "resource.aws_s3_bucket[dist].versioning.mfa_delete",
      "subType": "S3",
      "issue": "S3 bucket will not enforce MFA login on delete requests",
      "publicId": "SNYK-CC-TF-127",
      "title": "S3 bucket MFA delete control disabled",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html",
        "https://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html",
        "https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingMFADelete.html"
      ],
      "id": "SNYK-CC-TF-127",
      "isIgnored": false,
      "iacDescription": {
        "issue": "S3 bucket will not enforce MFA login on delete requests",
        "impact": "Object could be deleted without stronger MFA authorization",
        "resolve": "Follow instructions in `https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html` to manually configure the MFA setting. For AWS provider < v4.0.0 set `versioning.mfa_delete` attribute to `true` in aws_s3_bucket resource. For AWS provider >= v4.0.0 set 'versioning_configuration.mfa_delete` attribute to `Enabled`. The terraform change is required to reflect the setting in the state file"
      },
      "lineNumber": 14,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-127",
      "isGeneratedByCustomRule": false,
      "path": [
        "resource",
        "aws_s3_bucket[dist]",
        "versioning",
        "mfa_delete"
      ]
    },
    {
      "severity": "low",
      "resolve": "Set `web_acl_id` attribute to existing AWS WAF acl ARN",
      "id": "SNYK-CC-TF-75",
      "impact": "The WAF service will not protect the application from common web based attacks such as SQL injections",
      "msg": "resource.aws_cloudfront_distribution[s3_distribution].web_acl_id",
      "remediation": {
        "cloudformation": "Set `Properties.DistributionConfig.WebACLId` attribute to existing AWS WAF acl ARN",
        "terraform": "Set `web_acl_id` attribute to existing AWS WAF acl ARN"
      },
      "subType": "CloudFront",
      "issue": "The AWS WAF is not in front of cloudfront distribution",
      "publicId": "SNYK-CC-TF-75",
      "title": "Cloudfront distribution without WAF",
      "references": [
        "https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/distribution-web-awswaf.html",
        "https://docs.aws.amazon.com/waf/latest/developerguide/web-acl.html"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "The AWS WAF is not in front of cloudfront distribution",
        "impact": "The WAF service will not protect the application from common web based attacks such as SQL injections",
        "resolve": "Set `web_acl_id` attribute to existing AWS WAF acl ARN"
      },
      "lineNumber": 32,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-75",
      "isGeneratedByCustomRule": false,
      "path": [
        "resource",
        "aws_cloudfront_distribution[s3_distribution]",
        "web_acl_id"
      ]
    },
    {
      "severity": "low",
      "resolve": "For AWS provider < v4.0.0, set `versioning.enabled` attribute to `true`. For AWS provider >= v4.0.0, add aws_s3_bucket_versioning resource.",
      "id": "SNYK-CC-TF-124",
      "impact": "Changes or deletion of objects will not be reversible",
      "msg": "resource.aws_s3_bucket[logging].versioning.enabled",
      "remediation": {
        "cloudformation": "Set `Properties.VersioningConfiguration.Status` attribute to `Enabled`",
        "terraform": "For AWS provider < v4.0.0, set `versioning.enabled` attribute to `true`. For AWS provider >= v4.0.0, add aws_s3_bucket_versioning resource."
      },
      "subType": "S3",
      "issue": "S3 bucket versioning is disabled",
      "publicId": "SNYK-CC-TF-124",
      "title": "S3 bucket versioning disabled",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html"
      ],
      "isIgnored": false,
      "iacDescription": {
        "issue": "S3 bucket versioning is disabled",
        "impact": "Changes or deletion of objects will not be reversible",
        "resolve": "For AWS provider < v4.0.0, set `versioning.enabled` attribute to `true`. For AWS provider >= v4.0.0, add aws_s3_bucket_versioning resource."
      },
      "lineNumber": 5,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-124",
      "isGeneratedByCustomRule": false,
      "path": [
        "resource",
        "aws_s3_bucket[logging]",
        "versioning",
        "enabled"
      ]
    },
    {
      "severity": "medium",
      "resolve": "For AWS provider < v4.0.0, set `server_side_encryption_configuration` block attribute. For AWS provider >= v4.0.0 add aws_s3_bucket_server_side_encryption_configuration resource.",
      "impact": "A non-encrypted S3 bucket increases the likelihood of unintentional data exposure",
      "msg": "input.resource.aws_s3_bucket[logging]",
      "remediation": {
        "cloudformation": "Set `BucketEncryption` attribute",
        "terraform": "For AWS provider < v4.0.0, set `server_side_encryption_configuration` block attribute. For AWS provider >= v4.0.0 add aws_s3_bucket_server_side_encryption_configuration resource."
      },
      "subType": "S3",
      "issue": "Non-encrypted S3 Bucket",
      "publicId": "SNYK-CC-TF-4",
      "title": "Non-encrypted S3 Bucket",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/default-bucket-encryption.html",
        "CIS Amazon Web Services Foundations Benchmark v1.4.0 - 2.1.1 Ensure all S3 buckets employ encryption-at-rest"
      ],
      "id": "SNYK-CC-TF-4",
      "isIgnored": false,
      "iacDescription": {
        "issue": "Non-encrypted S3 Bucket",
        "impact": "A non-encrypted S3 bucket increases the likelihood of unintentional data exposure",
        "resolve": "For AWS provider < v4.0.0, set `server_side_encryption_configuration` block attribute. For AWS provider >= v4.0.0 add aws_s3_bucket_server_side_encryption_configuration resource."
      },
      "lineNumber": 5,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-4",
      "isGeneratedByCustomRule": false,
      "path": [
        "input",
        "resource",
        "aws_s3_bucket[logging]"
      ]
    },
    {
      "severity": "medium",
      "resolve": "For AWS provider < v4.0.0, set `server_side_encryption_configuration` block attribute. For AWS provider >= v4.0.0 add aws_s3_bucket_server_side_encryption_configuration resource.",
      "impact": "A non-encrypted S3 bucket increases the likelihood of unintentional data exposure",
      "msg": "input.resource.aws_s3_bucket[dist]",
      "remediation": {
        "cloudformation": "Set `BucketEncryption` attribute",
        "terraform": "For AWS provider < v4.0.0, set `server_side_encryption_configuration` block attribute. For AWS provider >= v4.0.0 add aws_s3_bucket_server_side_encryption_configuration resource."
      },
      "subType": "S3",
      "issue": "Non-encrypted S3 Bucket",
      "publicId": "SNYK-CC-TF-4",
      "title": "Non-encrypted S3 Bucket",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/default-bucket-encryption.html",
        "CIS Amazon Web Services Foundations Benchmark v1.4.0 - 2.1.1 Ensure all S3 buckets employ encryption-at-rest"
      ],
      "id": "SNYK-CC-TF-4",
      "isIgnored": false,
      "iacDescription": {
        "issue": "Non-encrypted S3 Bucket",
        "impact": "A non-encrypted S3 bucket increases the likelihood of unintentional data exposure",
        "resolve": "For AWS provider < v4.0.0, set `server_side_encryption_configuration` block attribute. For AWS provider >= v4.0.0 add aws_s3_bucket_server_side_encryption_configuration resource."
      },
      "lineNumber": 14,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-4",
      "isGeneratedByCustomRule": false,
      "path": [
        "input",
        "resource",
        "aws_s3_bucket[dist]"
      ]
    },
    {
      "severity": "low",
      "resolve": "Follow instructions in `https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html` to manually configure the MFA setting. For AWS provider < v4.0.0 set `versioning.mfa_delete` attribute to `true` in aws_s3_bucket resource. For AWS provider >= v4.0.0 set 'versioning_configuration.mfa_delete` attribute to `Enabled`. The terraform change is required to reflect the setting in the state file",
      "impact": "Object could be deleted without stronger MFA authorization",
      "msg": "resource.aws_s3_bucket[logging].versioning.mfa_delete",
      "subType": "S3",
      "issue": "S3 bucket will not enforce MFA login on delete requests",
      "publicId": "SNYK-CC-TF-127",
      "title": "S3 bucket MFA delete control disabled",
      "references": [
        "https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html",
        "https://docs.aws.amazon.com/AmazonS3/latest/dev/Versioning.html",
        "https://docs.aws.amazon.com/AmazonS3/latest/dev/UsingMFADelete.html"
      ],
      "id": "SNYK-CC-TF-127",
      "isIgnored": false,
      "iacDescription": {
        "issue": "S3 bucket will not enforce MFA login on delete requests",
        "impact": "Object could be deleted without stronger MFA authorization",
        "resolve": "Follow instructions in `https://docs.aws.amazon.com/AmazonS3/latest/userguide/MultiFactorAuthenticationDelete.html` to manually configure the MFA setting. For AWS provider < v4.0.0 set `versioning.mfa_delete` attribute to `true` in aws_s3_bucket resource. For AWS provider >= v4.0.0 set 'versioning_configuration.mfa_delete` attribute to `Enabled`. The terraform change is required to reflect the setting in the state file"
      },
      "lineNumber": 5,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-127",
      "isGeneratedByCustomRule": false,
      "path": [
        "resource",
        "aws_s3_bucket[logging]",
        "versioning",
        "mfa_delete"
      ]
    }
  ]
}

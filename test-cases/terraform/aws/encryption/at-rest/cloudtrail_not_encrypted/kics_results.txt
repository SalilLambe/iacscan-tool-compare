
                   .0MO.                                    
                   OMMMx                                    
                   ;NMX;                                    
                    ...           ...              ....     
WMMMd     cWMMM0.  KMMMO      ;xKWMMMMNOc.     ,xXMMMMMWXkc.
WMMMd   .0MMMN:    KMMMO    :XMMMMMMMMMMMWl   xMMMMMWMMMMMMl
WMMMd  lWMMMO.     KMMMO   xMMMMKc...'lXMk   ,MMMMx   .;dXx 
WMMMd.0MMMX;       KMMMO  cMMMMd        '    'MMMMNl'       
WMMMNWMMMMl        KMMMO  0MMMN               oMMMMMMMXkl.  
WMMMMMMMMMMo       KMMMO  0MMMX                .ckKWMMMMMM0.
WMMMMWokMMMMk      KMMMO  oMMMMc              .     .:OMMMM0
WMMMK.  dMMMM0.    KMMMO   KMMMMx'    ,kNc   :WOc.    .NMMMX
WMMMd    cWMMMX.   KMMMO    kMMMMMWXNMMMMMd .WMMMMWKO0NMMMMl
WMMMd     ,NMMMN,  KMMMO     'xNMMMMMMMNx,   .l0WMMMMMMMWk, 
xkkk:      ,kkkkx  okkkl        ;xKXKx;          ;dOKKkc    


Scanning with Keeping Infrastructure as Code Secure v1.5.3



Files scanned: 1
Parsed files: 1
Queries loaded: 859
Queries failed to execute: 0

------------------------------------

Resource Not Using Tags, Severity: INFO, Results: 2
Description: AWS services resource tags are an essential part of managing components
Platform: Terraform

	[1]: ../../src/main.tf:18

		017: 
		018: resource "aws_s3_bucket" "foo" {
		019:   bucket        = local.name


	[2]: ../../src/main.tf:11

		010: 
		011: resource "aws_cloudtrail" "foobar" {
		012:   name                          = local.name


S3 Bucket Logging Disabled, Severity: LOW, Results: 1
Description: S3 bucket without logging
Platform: Terraform

	[1]: ../../src/main.tf:18

		017: 
		018: resource "aws_s3_bucket" "foo" {
		019:   bucket        = local.name


CloudTrail Log File Validation Disabled, Severity: LOW, Results: 1
CIS ID: CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 3.2
Title: Ensure CloudTrail log file validation is enabled
Description: CloudTrail log file validation creates a digitally signed digest file containing a hash of each log that CloudTrail writes to S3. These digest files can be used to determine whether a log file was changed, deleted, or unchanged after CloudTrail delivered the log. It is recommended that file validation be enabled on all CloudTrails.
Enabling log file validation will provide additional integrity checking of CloudTrail logs.
Platform: Terraform

	[1]: ../../src/main.tf:11

		010: 
		011: resource "aws_cloudtrail" "foobar" {
		012:   name                          = local.name


S3 Bucket Without Versioning, Severity: MEDIUM, Results: 1
Description: S3 bucket should have versioning enabled
Platform: Terraform

	[1]: ../../src/main.tf:18

		017: 
		018: resource "aws_s3_bucket" "foo" {
		019:   bucket        = local.name


S3 Bucket Policy Accepts HTTP Requests, Severity: MEDIUM, Results: 1
Description: S3 Bucket policy should not accept HTTP Requests
Platform: Terraform

	[1]: ../../src/main.tf:22

		021: 
		022:   policy = <<POLICY
		023: {


IAM Access Analyzer Undefined, Severity: MEDIUM, Results: 1
Description: IAM Access Analyzer should be defined to identify unintentional access
Platform: Terraform

	[1]: ../../src/main.tf:11

		010: 
		011: resource "aws_cloudtrail" "foobar" {
		012:   name                          = local.name


CloudTrail SNS Topic Name Undefined, Severity: MEDIUM, Results: 1
Description: Check if SNS topic name is set for CloudTrail
Platform: Terraform

	[1]: ../../src/main.tf:11

		010: 
		011: resource "aws_cloudtrail" "foobar" {
		012:   name                          = local.name


CloudTrail Not Integrated With CloudWatch, Severity: MEDIUM, Results: 2
Description: CloudTrail should be integrated with CloudWatch
Platform: Terraform

	[1]: ../../src/main.tf:11

		010: 
		011: resource "aws_cloudtrail" "foobar" {
		012:   name                          = local.name


	[2]: ../../src/main.tf:11

		010: 
		011: resource "aws_cloudtrail" "foobar" {
		012:   name                          = local.name


CloudTrail Multi Region Disabled, Severity: MEDIUM, Results: 2
CIS ID: CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 3.1
Title: Ensure CloudTrail is enabled in all regions
Description: AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation).
The AWS API call history produced by CloudTrail enables security analysis, resource change tracking, and compliance auditing. Additionally, ensuring that a multi-regions trail exists will ensure that unexpected activity occurring in otherwise unused regions is detected ensuring that a multi-regions trail exists will ensure that Global Service Logging is enabled for a trail by default to capture recording of events generated onAWS global services for a multi-regions trail, ensuring that management events configured for all type of Read/Writes ensures recording of management operations that are performed on all resources in an AWS account 
Platform: Terraform

	[1]: ../../src/main.tf:15

		014:   s3_key_prefix                 = "prefix"
		015:   include_global_service_events = false
		016: }


	[2]: ../../src/main.tf:11

		010: 
		011: resource "aws_cloudtrail" "foobar" {
		012:   name                          = local.name


S3 Bucket Without Enabled MFA Delete, Severity: HIGH, Results: 1
CIS ID: CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 2.1.3
Title: Ensure MFA Delete is enable on S3 buckets
Description: Once MFA Delete is enabled on your sensitive and classified S3 bucket it requires the user to have two forms of authentication.
Adding MFA delete to an S3 bucket, requires additional authentication when you change the version state of your bucket or you delete and object version adding another layer of security in the event your security credentials are compromised or unauthorized access is granted.
Platform: Terraform

	[1]: ../../src/main.tf:18

		017: 
		018: resource "aws_s3_bucket" "foo" {
		019:   bucket        = local.name


S3 Bucket SSE Disabled, Severity: HIGH, Results: 1
Description: If algorithm is AES256 then the master key is null, empty or undefined, otherwise the master key is required
Platform: Terraform

	[1]: ../../src/main.tf:18

		017: 
		018: resource "aws_s3_bucket" "foo" {
		019:   bucket        = local.name


CloudTrail Log Files S3 Bucket with Logging Disabled, Severity: HIGH, Results: 1
Description: CloudTrail Log Files S3 Bucket should have 'logging' enabled
Platform: Terraform

	[1]: ../../src/main.tf:18

		017: 
		018: resource "aws_s3_bucket" "foo" {
		019:   bucket        = local.name


CloudTrail Log Files Not Encrypted, Severity: HIGH, Results: 1
CIS ID: CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 3.7
Title: Ensure CloudTrail logs are encrypted at rest using KMS CMKs
Description: AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS.
Configuring CloudTrail to use SSE-KMS provides additional confidentiality controls on log data as a given user must have S3 read permission on the corresponding log bucket and must be granted decrypt permission by the CMK policy.
Platform: Terraform

	[1]: ../../src/main.tf:11

		010: 
		011: resource "aws_cloudtrail" "foobar" {
		012:   name                          = local.name



Results Summary:
HIGH: 4
MEDIUM: 8
LOW: 2
INFO: 2
TOTAL: 16

Scan duration: 25.660375977s

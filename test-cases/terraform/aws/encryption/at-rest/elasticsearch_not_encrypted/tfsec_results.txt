
Result #1 CRITICAL Domain does not enforce HTTPS. 
────────────────────────────────────────────────────────────────────────────────
 main.tf Lines 1-16
───────┬────────────────────────────────────────────────────────────────────────
    1  │ resource "aws_elasticsearch_domain" "example" {
    2  │   domain_name           = "example"
    3  │   elasticsearch_version = "1.5"
    4  │ 
    5  │   cluster_config {
    6  │     instance_type = "r4.large.elasticsearch"
    7  │   }
    8  │ 
    9  │   snapshot_options {
   10  │     automated_snapshot_start_hour = 23
   11  │   }
   12  │ 
   13  │   tags = {
   14  │     Domain = "TestDomain"
   15  │   }
   16  │ }
───────┴────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-enforce-https
      Impact HTTP traffic can be intercepted and the contents read
  Resolution Enforce the use of HTTPS for ElasticSearch

  More Information
  - https://aquasecurity.github.io/tfsec/v1.8.0/checks/aws/elastic-search/enforce-https/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#enforce_https
────────────────────────────────────────────────────────────────────────────────


Result #2 HIGH Domain does not have in-transit encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
 main.tf Lines 1-16
───────┬────────────────────────────────────────────────────────────────────────
    1  │ resource "aws_elasticsearch_domain" "example" {
    2  │   domain_name           = "example"
    3  │   elasticsearch_version = "1.5"
    4  │ 
    5  │   cluster_config {
    6  │     instance_type = "r4.large.elasticsearch"
    7  │   }
    8  │ 
    9  │   snapshot_options {
   10  │     automated_snapshot_start_hour = 23
   11  │   }
   12  │ 
   13  │   tags = {
   14  │     Domain = "TestDomain"
   15  │   }
   16  │ }
───────┴────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-enable-in-transit-encryption
      Impact In transit data between nodes could be read if intercepted
  Resolution Enable encrypted node to node communication

  More Information
  - https://aquasecurity.github.io/tfsec/v1.8.0/checks/aws/elastic-search/enable-in-transit-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest
────────────────────────────────────────────────────────────────────────────────


Result #3 HIGH Domain does not have at-rest encryption enabled. 
────────────────────────────────────────────────────────────────────────────────
 main.tf Lines 1-16
───────┬────────────────────────────────────────────────────────────────────────
    1  │ resource "aws_elasticsearch_domain" "example" {
    2  │   domain_name           = "example"
    3  │   elasticsearch_version = "1.5"
    4  │ 
    5  │   cluster_config {
    6  │     instance_type = "r4.large.elasticsearch"
    7  │   }
    8  │ 
    9  │   snapshot_options {
   10  │     automated_snapshot_start_hour = 23
   11  │   }
   12  │ 
   13  │   tags = {
   14  │     Domain = "TestDomain"
   15  │   }
   16  │ }
───────┴────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-enable-domain-encryption
      Impact Data will be readable if compromised
  Resolution Enable ElasticSearch domain encryption

  More Information
  - https://aquasecurity.github.io/tfsec/v1.8.0/checks/aws/elastic-search/enable-domain-encryption/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#encrypt_at_rest
────────────────────────────────────────────────────────────────────────────────


Result #4 HIGH Domain does not have a secure TLS policy. 
────────────────────────────────────────────────────────────────────────────────
 main.tf Lines 1-16
───────┬────────────────────────────────────────────────────────────────────────
    1  │ resource "aws_elasticsearch_domain" "example" {
    2  │   domain_name           = "example"
    3  │   elasticsearch_version = "1.5"
    4  │ 
    5  │   cluster_config {
    6  │     instance_type = "r4.large.elasticsearch"
    7  │   }
    8  │ 
    9  │   snapshot_options {
   10  │     automated_snapshot_start_hour = 23
   11  │   }
   12  │ 
   13  │   tags = {
   14  │     Domain = "TestDomain"
   15  │   }
   16  │ }
───────┴────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-use-secure-tls-policy
      Impact Outdated SSL policies increase exposure to known vulnerabilities
  Resolution Use the most modern TLS/SSL policies available

  More Information
  - https://aquasecurity.github.io/tfsec/v1.8.0/checks/aws/elastic-search/use-secure-tls-policy/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#tls_security_policy
────────────────────────────────────────────────────────────────────────────────


Result #5 MEDIUM Domain audit logging is not enabled. 
────────────────────────────────────────────────────────────────────────────────
 main.tf Lines 1-16
───────┬────────────────────────────────────────────────────────────────────────
    1  │ resource "aws_elasticsearch_domain" "example" {
    2  │   domain_name           = "example"
    3  │   elasticsearch_version = "1.5"
    4  │ 
    5  │   cluster_config {
    6  │     instance_type = "r4.large.elasticsearch"
    7  │   }
    8  │ 
    9  │   snapshot_options {
   10  │     automated_snapshot_start_hour = 23
   11  │   }
   12  │ 
   13  │   tags = {
   14  │     Domain = "TestDomain"
   15  │   }
   16  │ }
───────┴────────────────────────────────────────────────────────────────────────
          ID aws-elastic-search-enable-domain-logging
      Impact Logging provides vital information about access and usage
  Resolution Enable logging for ElasticSearch domains

  More Information
  - https://aquasecurity.github.io/tfsec/v1.8.0/checks/aws/elastic-search/enable-domain-logging/
  - https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elasticsearch_domain#log_type
────────────────────────────────────────────────────────────────────────────────


  timings
  ──────────────────────────────────────────
  disk i/o             1.599412ms
  parsing              249.102µs
  adaptation           72.501µs
  checks               1.728012ms
  total                3.649027ms

  counts
  ──────────────────────────────────────────
  blocks               1
  modules              1
  files                1

  results
  ──────────────────────────────────────────
  ignored              0
  excluded             0
  critical             1
  high                 3
  medium               1
  low                  0

  5 potential problem(s) detected.


{
  "meta": {
    "isPrivate": true,
    "isLicensesEnabled": false,
    "ignoreSettings": null,
    "org": "salillambe",
    "policy": ""
  },
  "filesystemPolicy": false,
  "vulnerabilities": [],
  "dependencyCount": 0,
  "licensesPolicy": null,
  "ignoreSettings": null,
  "targetFile": "main.tf",
  "projectName": "project",
  "org": "salillambe",
  "policy": "",
  "isPrivate": true,
  "targetFilePath": "/project/main.tf",
  "packageManager": "terraformconfig",
  "path": "/project",
  "projectType": "terraformconfig",
  "ok": false,
  "infrastructureAsCodeIssues": [
    {
      "severity": "medium",
      "resolve": "Set `Principal` attribute in the policy to specific entities, for example `arn:aws:iam::123456789012:user/JohnDoe`",
      "impact": "Using wild card will grant unnecessary access to any user in the account",
      "msg": "resource.aws_kms_key[not_secure_policy].policy",
      "remediation": {
        "cloudformation": "Set `Principal` attribute in the policy to specific entities, for example `arn:aws:iam::123456789012:user/JohnDoe`",
        "terraform": "Set `Principal` attribute in the policy to specific entities, for example `arn:aws:iam::123456789012:user/JohnDoe`"
      },
      "subType": "KMS",
      "issue": "Wildcard principal has been specified in access policy",
      "publicId": "SNYK-CC-AWS-709",
      "title": "Wildcard principal in KMS key access policy",
      "references": [
        "https://docs.aws.amazon.com/IAM/latest/UserGuide/best-practices.html#grant-least-privilege",
        "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/secretsmanager_secret_policy",
        "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-resource-secretsmanager-resourcepolicy.html"
      ],
      "id": "SNYK-CC-AWS-709",
      "isIgnored": false,
      "iacDescription": {
        "issue": "Wildcard principal has been specified in access policy",
        "impact": "Using wild card will grant unnecessary access to any user in the account",
        "resolve": "Set `Principal` attribute in the policy to specific entities, for example `arn:aws:iam::123456789012:user/JohnDoe`"
      },
      "lineNumber": 9,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-AWS-709",
      "isGeneratedByCustomRule": false,
      "path": [
        "resource",
        "aws_kms_key[not_secure_policy]",
        "policy"
      ]
    },
    {
      "severity": "low",
      "resolve": "Set `enable_key_rotation` attribute to `true`",
      "id": "SNYK-CC-TF-14",
      "impact": "That data is being encrypted with a key which is valid for a longer period of time, resulting in a greater exposure window should that key be leaked",
      "msg": "input.resource.aws_kms_key[not_secure_policy].enable_key_rotation",
      "remediation": {
        "cloudformation": "Set `Properties.EnableKeyRotation` attribute to `true`",
        "terraform": "Set `enable_key_rotation` attribute to `true`"
      },
      "subType": "KMS",
      "issue": "That your encryption keys are not being rotated by AWS",
      "publicId": "SNYK-CC-TF-14",
      "title": "KMS key does not have key rotation enabled",
      "references": [],
      "isIgnored": false,
      "iacDescription": {
        "issue": "That your encryption keys are not being rotated by AWS",
        "impact": "That data is being encrypted with a key which is valid for a longer period of time, resulting in a greater exposure window should that key be leaked",
        "resolve": "Set `enable_key_rotation` attribute to `true`"
      },
      "lineNumber": 5,
      "documentation": "https://snyk.io/security-rules/SNYK-CC-TF-14",
      "isGeneratedByCustomRule": false,
      "path": [
        "input",
        "resource",
        "aws_kms_key[not_secure_policy]",
        "enable_key_rotation"
      ]
    }
  ]
}

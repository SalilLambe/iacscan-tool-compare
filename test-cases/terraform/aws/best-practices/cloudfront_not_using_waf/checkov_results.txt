terraform scan results:

Passed checks: 6, Failed checks: 10, Skipped checks: 0

Check: CKV_AWS_21: "Ensure all data stored in the S3 bucket have versioning enabled"
	FAILED for resource: aws_s3_bucket.b
	File: /main.tf:1-7
	Guide: https://docs.bridgecrew.io/docs/s3_16-enable-versioning

		1 | resource "aws_s3_bucket" "b" {
		2 |   bucket = "mybucket"
		3 | 
		4 |   tags = {
		5 |     Name = "My bucket"
		6 |   }
		7 | }

Check: CKV_AWS_18: "Ensure the S3 bucket has access logging enabled"
	FAILED for resource: aws_s3_bucket.b
	File: /main.tf:1-7
	Guide: https://docs.bridgecrew.io/docs/s3_13-enable-logging

		1 | resource "aws_s3_bucket" "b" {
		2 |   bucket = "mybucket"
		3 | 
		4 |   tags = {
		5 |     Name = "My bucket"
		6 |   }
		7 | }

Check: CKV_AWS_145: "Ensure that S3 buckets are encrypted with KMS by default"
	FAILED for resource: aws_s3_bucket.b
	File: /main.tf:1-7
	Guide: https://docs.bridgecrew.io/docs/ensure-that-s3-buckets-are-encrypted-with-kms-by-default

		1 | resource "aws_s3_bucket" "b" {
		2 |   bucket = "mybucket"
		3 | 
		4 |   tags = {
		5 |     Name = "My bucket"
		6 |   }
		7 | }

Check: CKV_AWS_144: "Ensure that S3 bucket has cross-region replication enabled"
	FAILED for resource: aws_s3_bucket.b
	File: /main.tf:1-7
	Guide: https://docs.bridgecrew.io/docs/ensure-that-s3-bucket-has-cross-region-replication-enabled

		1 | resource "aws_s3_bucket" "b" {
		2 |   bucket = "mybucket"
		3 | 
		4 |   tags = {
		5 |     Name = "My bucket"
		6 |   }
		7 | }

Check: CKV_AWS_19: "Ensure all data stored in the S3 bucket is securely encrypted at rest"
	FAILED for resource: aws_s3_bucket.b
	File: /main.tf:1-7
	Guide: https://docs.bridgecrew.io/docs/s3_14-data-encrypted-at-rest

		1 | resource "aws_s3_bucket" "b" {
		2 |   bucket = "mybucket"
		3 | 
		4 |   tags = {
		5 |     Name = "My bucket"
		6 |   }
		7 | }

Check: CKV_AWS_68: "CloudFront Distribution should have WAF enabled"
	FAILED for resource: aws_cloudfront_distribution.s3_distribution
	File: /main.tf:13-116
	Guide: https://docs.bridgecrew.io/docs/bc_aws_general_27

		13  | resource "aws_cloudfront_distribution" "s3_distribution" {
		14  |   origin {
		15  |     domain_name = aws_s3_bucket.b.bucket_regional_domain_name
		16  |     origin_id   = local.s3_origin_id
		17  | 
		18  |     s3_origin_config {
		19  |       origin_access_identity = "origin-access-identity/cloudfront/ABCDEFG1234567"
		20  |     }
		21  |   }
		22  | 
		23  |   enabled             = true
		24  |   is_ipv6_enabled     = true
		25  |   comment             = "Some comment"
		26  |   default_root_object = "index.html"
		27  | 
		28  |   logging_config {
		29  |     include_cookies = false
		30  |     bucket          = "mylogs.s3.amazonaws.com"
		31  |     prefix          = "myprefix"
		32  |   }
		33  | 
		34  |   aliases = ["mysite.example.com", "yoursite.example.com"]
		35  | 
		36  |   default_cache_behavior {
		37  |     allowed_methods  = ["DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT"]
		38  |     cached_methods   = ["GET", "HEAD"]
		39  |     target_origin_id = local.s3_origin_id
		40  | 
		41  |     forwarded_values {
		42  |       query_string = false
		43  | 
		44  |       cookies {
		45  |         forward = "none"
		46  |       }
		47  |     }
		48  | 
		49  |     viewer_protocol_policy = "allow-all"
		50  |     min_ttl                = 0
		51  |     default_ttl            = 3600
		52  |     max_ttl                = 86400
		53  |   }
		54  | 
		55  |   # Cache behavior with precedence 0
		56  |   ordered_cache_behavior {
		57  |     path_pattern     = "/content/immutable/*"
		58  |     allowed_methods  = ["GET", "HEAD", "OPTIONS"]
		59  |     cached_methods   = ["GET", "HEAD", "OPTIONS"]
		60  |     target_origin_id = local.s3_origin_id
		61  | 
		62  |     forwarded_values {
		63  |       query_string = false
		64  |       headers      = ["Origin"]
		65  | 
		66  |       cookies {
		67  |         forward = "none"
		68  |       }
		69  |     }
		70  | 
		71  |     min_ttl                = 0
		72  |     default_ttl            = 86400
		73  |     max_ttl                = 31536000
		74  |     compress               = true
		75  |     viewer_protocol_policy = "redirect-to-https"
		76  |   }
		77  | 
		78  |   # Cache behavior with precedence 1
		79  |   ordered_cache_behavior {
		80  |     path_pattern     = "/content/*"
		81  |     allowed_methods  = ["GET", "HEAD", "OPTIONS"]
		82  |     cached_methods   = ["GET", "HEAD"]
		83  |     target_origin_id = local.s3_origin_id
		84  | 
		85  |     forwarded_values {
		86  |       query_string = false
		87  | 
		88  |       cookies {
		89  |         forward = "none"
		90  |       }
		91  |     }
		92  | 
		93  |     min_ttl                = 0
		94  |     default_ttl            = 3600
		95  |     max_ttl                = 86400
		96  |     compress               = true
		97  |     viewer_protocol_policy = "redirect-to-https"
		98  |   }
		99  | 
		100 |   price_class = "PriceClass_200"
		101 | 
		102 |   restrictions {
		103 |     geo_restriction {
		104 |       restriction_type = "whitelist"
		105 |       locations        = ["US", "CA", "GB", "DE"]
		106 |     }
		107 |   }
		108 | 
		109 |   tags = {
		110 |     Environment = "production"
		111 |   }
		112 | 
		113 |   viewer_certificate {
		114 |     cloudfront_default_certificate = true
		115 |   }
		116 | }

Check: CKV_AWS_174: "Verify CloudFront Distribution Viewer Certificate is using TLS v1.2"
	FAILED for resource: aws_cloudfront_distribution.s3_distribution
	File: /main.tf:13-116
	Guide: https://docs.bridgecrew.io/docs/bc_aws_networking_63

		13  | resource "aws_cloudfront_distribution" "s3_distribution" {
		14  |   origin {
		15  |     domain_name = aws_s3_bucket.b.bucket_regional_domain_name
		16  |     origin_id   = local.s3_origin_id
		17  | 
		18  |     s3_origin_config {
		19  |       origin_access_identity = "origin-access-identity/cloudfront/ABCDEFG1234567"
		20  |     }
		21  |   }
		22  | 
		23  |   enabled             = true
		24  |   is_ipv6_enabled     = true
		25  |   comment             = "Some comment"
		26  |   default_root_object = "index.html"
		27  | 
		28  |   logging_config {
		29  |     include_cookies = false
		30  |     bucket          = "mylogs.s3.amazonaws.com"
		31  |     prefix          = "myprefix"
		32  |   }
		33  | 
		34  |   aliases = ["mysite.example.com", "yoursite.example.com"]
		35  | 
		36  |   default_cache_behavior {
		37  |     allowed_methods  = ["DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT"]
		38  |     cached_methods   = ["GET", "HEAD"]
		39  |     target_origin_id = local.s3_origin_id
		40  | 
		41  |     forwarded_values {
		42  |       query_string = false
		43  | 
		44  |       cookies {
		45  |         forward = "none"
		46  |       }
		47  |     }
		48  | 
		49  |     viewer_protocol_policy = "allow-all"
		50  |     min_ttl                = 0
		51  |     default_ttl            = 3600
		52  |     max_ttl                = 86400
		53  |   }
		54  | 
		55  |   # Cache behavior with precedence 0
		56  |   ordered_cache_behavior {
		57  |     path_pattern     = "/content/immutable/*"
		58  |     allowed_methods  = ["GET", "HEAD", "OPTIONS"]
		59  |     cached_methods   = ["GET", "HEAD", "OPTIONS"]
		60  |     target_origin_id = local.s3_origin_id
		61  | 
		62  |     forwarded_values {
		63  |       query_string = false
		64  |       headers      = ["Origin"]
		65  | 
		66  |       cookies {
		67  |         forward = "none"
		68  |       }
		69  |     }
		70  | 
		71  |     min_ttl                = 0
		72  |     default_ttl            = 86400
		73  |     max_ttl                = 31536000
		74  |     compress               = true
		75  |     viewer_protocol_policy = "redirect-to-https"
		76  |   }
		77  | 
		78  |   # Cache behavior with precedence 1
		79  |   ordered_cache_behavior {
		80  |     path_pattern     = "/content/*"
		81  |     allowed_methods  = ["GET", "HEAD", "OPTIONS"]
		82  |     cached_methods   = ["GET", "HEAD"]
		83  |     target_origin_id = local.s3_origin_id
		84  | 
		85  |     forwarded_values {
		86  |       query_string = false
		87  | 
		88  |       cookies {
		89  |         forward = "none"
		90  |       }
		91  |     }
		92  | 
		93  |     min_ttl                = 0
		94  |     default_ttl            = 3600
		95  |     max_ttl                = 86400
		96  |     compress               = true
		97  |     viewer_protocol_policy = "redirect-to-https"
		98  |   }
		99  | 
		100 |   price_class = "PriceClass_200"
		101 | 
		102 |   restrictions {
		103 |     geo_restriction {
		104 |       restriction_type = "whitelist"
		105 |       locations        = ["US", "CA", "GB", "DE"]
		106 |     }
		107 |   }
		108 | 
		109 |   tags = {
		110 |     Environment = "production"
		111 |   }
		112 | 
		113 |   viewer_certificate {
		114 |     cloudfront_default_certificate = true
		115 |   }
		116 | }

Check: CKV_AWS_34: "Ensure cloudfront distribution ViewerProtocolPolicy is set to HTTPS"
	FAILED for resource: aws_cloudfront_distribution.s3_distribution
	File: /main.tf:13-116
	Guide: https://docs.bridgecrew.io/docs/networking_32

		13  | resource "aws_cloudfront_distribution" "s3_distribution" {
		14  |   origin {
		15  |     domain_name = aws_s3_bucket.b.bucket_regional_domain_name
		16  |     origin_id   = local.s3_origin_id
		17  | 
		18  |     s3_origin_config {
		19  |       origin_access_identity = "origin-access-identity/cloudfront/ABCDEFG1234567"
		20  |     }
		21  |   }
		22  | 
		23  |   enabled             = true
		24  |   is_ipv6_enabled     = true
		25  |   comment             = "Some comment"
		26  |   default_root_object = "index.html"
		27  | 
		28  |   logging_config {
		29  |     include_cookies = false
		30  |     bucket          = "mylogs.s3.amazonaws.com"
		31  |     prefix          = "myprefix"
		32  |   }
		33  | 
		34  |   aliases = ["mysite.example.com", "yoursite.example.com"]
		35  | 
		36  |   default_cache_behavior {
		37  |     allowed_methods  = ["DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT"]
		38  |     cached_methods   = ["GET", "HEAD"]
		39  |     target_origin_id = local.s3_origin_id
		40  | 
		41  |     forwarded_values {
		42  |       query_string = false
		43  | 
		44  |       cookies {
		45  |         forward = "none"
		46  |       }
		47  |     }
		48  | 
		49  |     viewer_protocol_policy = "allow-all"
		50  |     min_ttl                = 0
		51  |     default_ttl            = 3600
		52  |     max_ttl                = 86400
		53  |   }
		54  | 
		55  |   # Cache behavior with precedence 0
		56  |   ordered_cache_behavior {
		57  |     path_pattern     = "/content/immutable/*"
		58  |     allowed_methods  = ["GET", "HEAD", "OPTIONS"]
		59  |     cached_methods   = ["GET", "HEAD", "OPTIONS"]
		60  |     target_origin_id = local.s3_origin_id
		61  | 
		62  |     forwarded_values {
		63  |       query_string = false
		64  |       headers      = ["Origin"]
		65  | 
		66  |       cookies {
		67  |         forward = "none"
		68  |       }
		69  |     }
		70  | 
		71  |     min_ttl                = 0
		72  |     default_ttl            = 86400
		73  |     max_ttl                = 31536000
		74  |     compress               = true
		75  |     viewer_protocol_policy = "redirect-to-https"
		76  |   }
		77  | 
		78  |   # Cache behavior with precedence 1
		79  |   ordered_cache_behavior {
		80  |     path_pattern     = "/content/*"
		81  |     allowed_methods  = ["GET", "HEAD", "OPTIONS"]
		82  |     cached_methods   = ["GET", "HEAD"]
		83  |     target_origin_id = local.s3_origin_id
		84  | 
		85  |     forwarded_values {
		86  |       query_string = false
		87  | 
		88  |       cookies {
		89  |         forward = "none"
		90  |       }
		91  |     }
		92  | 
		93  |     min_ttl                = 0
		94  |     default_ttl            = 3600
		95  |     max_ttl                = 86400
		96  |     compress               = true
		97  |     viewer_protocol_policy = "redirect-to-https"
		98  |   }
		99  | 
		100 |   price_class = "PriceClass_200"
		101 | 
		102 |   restrictions {
		103 |     geo_restriction {
		104 |       restriction_type = "whitelist"
		105 |       locations        = ["US", "CA", "GB", "DE"]
		106 |     }
		107 |   }
		108 | 
		109 |   tags = {
		110 |     Environment = "production"
		111 |   }
		112 | 
		113 |   viewer_certificate {
		114 |     cloudfront_default_certificate = true
		115 |   }
		116 | }

Check: CKV2_AWS_6: "Ensure that S3 bucket has a Public Access block"
	FAILED for resource: aws_s3_bucket.b
	File: /main.tf:1-7
	Guide: https://docs.bridgecrew.io/docs/s3-bucket-should-have-public-access-blocks-defaults-to-false-if-the-public-access-block-is-not-attached

		1 | resource "aws_s3_bucket" "b" {
		2 |   bucket = "mybucket"
		3 | 
		4 |   tags = {
		5 |     Name = "My bucket"
		6 |   }
		7 | }

Check: CKV2_AWS_32: "Ensure CloudFront distribution has a strict security headers policy attached"
	FAILED for resource: aws_cloudfront_distribution.s3_distribution
	File: /main.tf:13-116
	Guide: https://docs.bridgecrew.io/docs/bc_aws_networking_65

		13  | resource "aws_cloudfront_distribution" "s3_distribution" {
		14  |   origin {
		15  |     domain_name = aws_s3_bucket.b.bucket_regional_domain_name
		16  |     origin_id   = local.s3_origin_id
		17  | 
		18  |     s3_origin_config {
		19  |       origin_access_identity = "origin-access-identity/cloudfront/ABCDEFG1234567"
		20  |     }
		21  |   }
		22  | 
		23  |   enabled             = true
		24  |   is_ipv6_enabled     = true
		25  |   comment             = "Some comment"
		26  |   default_root_object = "index.html"
		27  | 
		28  |   logging_config {
		29  |     include_cookies = false
		30  |     bucket          = "mylogs.s3.amazonaws.com"
		31  |     prefix          = "myprefix"
		32  |   }
		33  | 
		34  |   aliases = ["mysite.example.com", "yoursite.example.com"]
		35  | 
		36  |   default_cache_behavior {
		37  |     allowed_methods  = ["DELETE", "GET", "HEAD", "OPTIONS", "PATCH", "POST", "PUT"]
		38  |     cached_methods   = ["GET", "HEAD"]
		39  |     target_origin_id = local.s3_origin_id
		40  | 
		41  |     forwarded_values {
		42  |       query_string = false
		43  | 
		44  |       cookies {
		45  |         forward = "none"
		46  |       }
		47  |     }
		48  | 
		49  |     viewer_protocol_policy = "allow-all"
		50  |     min_ttl                = 0
		51  |     default_ttl            = 3600
		52  |     max_ttl                = 86400
		53  |   }
		54  | 
		55  |   # Cache behavior with precedence 0
		56  |   ordered_cache_behavior {
		57  |     path_pattern     = "/content/immutable/*"
		58  |     allowed_methods  = ["GET", "HEAD", "OPTIONS"]
		59  |     cached_methods   = ["GET", "HEAD", "OPTIONS"]
		60  |     target_origin_id = local.s3_origin_id
		61  | 
		62  |     forwarded_values {
		63  |       query_string = false
		64  |       headers      = ["Origin"]
		65  | 
		66  |       cookies {
		67  |         forward = "none"
		68  |       }
		69  |     }
		70  | 
		71  |     min_ttl                = 0
		72  |     default_ttl            = 86400
		73  |     max_ttl                = 31536000
		74  |     compress               = true
		75  |     viewer_protocol_policy = "redirect-to-https"
		76  |   }
		77  | 
		78  |   # Cache behavior with precedence 1
		79  |   ordered_cache_behavior {
		80  |     path_pattern     = "/content/*"
		81  |     allowed_methods  = ["GET", "HEAD", "OPTIONS"]
		82  |     cached_methods   = ["GET", "HEAD"]
		83  |     target_origin_id = local.s3_origin_id
		84  | 
		85  |     forwarded_values {
		86  |       query_string = false
		87  | 
		88  |       cookies {
		89  |         forward = "none"
		90  |       }
		91  |     }
		92  | 
		93  |     min_ttl                = 0
		94  |     default_ttl            = 3600
		95  |     max_ttl                = 86400
		96  |     compress               = true
		97  |     viewer_protocol_policy = "redirect-to-https"
		98  |   }
		99  | 
		100 |   price_class = "PriceClass_200"
		101 | 
		102 |   restrictions {
		103 |     geo_restriction {
		104 |       restriction_type = "whitelist"
		105 |       locations        = ["US", "CA", "GB", "DE"]
		106 |     }
		107 |   }
		108 | 
		109 |   tags = {
		110 |     Environment = "production"
		111 |   }
		112 | 
		113 |   viewer_certificate {
		114 |     cloudfront_default_certificate = true
		115 |   }
		116 | }


